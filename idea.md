# Hackathon 2026 Competition

基本思路：

为 Meme Coin 交易平台引入质押机制，诱导平缓的卖出行为（避免 rug 式的极端撤出），并对质押撤出行为进行罚没，对因此可能导致的其他用户损失进行补偿；

具体的，用户在购买 meme coin 后可以选择质押一定量的 coin 到平台；在有用户进行质押撤出时，对用户的撤出行为生成撤出行为分数，依据分数罚没对应比例的 coin 并自动出售为 ETH；并按照所有用户的质押行为生成质押行为分数，依据质押行为分数进行罚没所得 ETH 分配。

## 角色

### random guy

买入token（前端/合约端可以写聚合器，聚合官方流动性和本平台流动性）

查看本平台卖压图

加入质押（质押时选择单边流动性开始出货的卖出价格 质押数量）

显示质押平台信息

### LP / Holder（质押者）

- 随价格上涨，单边流动性自动出货（可以借助mev思路 通过给bot reward实现 同时也会在通过平台流动性购买的时候自动触发）
- 获得保险罚没收益（需要根据质押积分分配）
- 跑路出货 出货时会被罚没一定比例的token，同时这部分token会通过智能合约自动卖出用于补偿质押者（市场操纵？），使得提取跑路会受到损失。罚没比例可能需要进行进一步综合计算
- 质押行为要基于NFT实现，使得一个address可以开多个仓位（仓位绑定nft，一个用户可以持有多个nft）。nft可以是可转移的，也可以不可转移，具体看实现复杂度。
- AMM流动性公式参照x*y=k的经典方法。注意本项目是单边流动性，因此相当于是保证x*x*p不变，其中x是token数量，p是价格，具体实现时可以使用虚拟流动性（虚拟y）的方法。

### Protocol

- 质押行为打分
- 退出行为打分
- 触发对应罚没

## 质押行为打分

当有其他用户退出stake时，使用**当前**剩余token量*时间惩罚系数，作为质押行为打分。其中当前的含义是，要考虑到用户单边流动性场景下，可能已经自动卖出了一部分token，此时只能用剩下的没卖出的部分参与比例分配。对于时间惩罚系数，设定为：当用户刚加入stake时，时间系数为0，这意味着用户不能从其他参与者手上获取退出资金；当用户stake时间超过7天时，时间系数为1，意味着用户可以以正常权重参与分配；当用户时间在7天内时，时间系数线性增长。当罚没行为发生时，对于所有用户，其根据质押行为分，进行按权重的平均分配。

注意，质押实现时，希望所有用户操作都是O（常数）的，这就意味着上述状态需要进行lazy的更新，需要对状态存储方式进行详细的设计。有一些可能可以使用（但是可能会造成精度损失）的思路：1.时间惩罚系数可以是伪线性，例如可以按2小时将时间分块，之后每次对分块的内容进行更新。2.注意到当价格增长的时候，所有卖出价格低于新价格的仓位都会进行出货行为，此时这些仓位的新的卖出价格会同步增长（正好增长到新的价格），因此在这一块可能可以进行状态压缩。3.有必要时也可以对价格采用分块bitmap的技巧。

## 退出行为打分

为了简化实现，用户退出时，只能整个NFT整体burn，不能部分退出仓位。

用户退出时，需要根据NFT持有时间和价格差进行打分，并根据打分从退出仓位中没收一部分。没收的部分会自动出售为eth然后分给质押者。

时间打分：最高10%。当用户刚加入时，没收10%。当用户加入7天时，没收5%。即0.7/(d+7)（注意这是大概公式，具体最好精度到秒）

价格差打分：当用户已经开始卖时，即当前价格=卖出价格，没收10%。当前价格是卖出价格两倍时，没收5%。即没收比例为0.1/k，其中k为卖出价格比当前价格的倍数。

一些合约细节：

meme平台的所有pair都是和eth的pair。meme平台使用的是闭源curve控制价格的，但是有外部函数可以进行买卖（以及买卖模拟）。
